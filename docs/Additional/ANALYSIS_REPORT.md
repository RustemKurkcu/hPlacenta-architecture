<h1>Comprehensive Analysis Report</h1><h1>Spatiotemporal Dynamics of Placental Nutritional Immunity:</h1><h1>The "Vicious Cycle" of F. nucleatum Infection and Preeclampsia</h1><hr><h2>1. Project Overview</h2><h3>1.1 Central Hypothesis</h3><p><em>Fusobacterium nucleatum</em> exploits the unique immunological and metabolic landscape of the human placenta to establish a self-reinforcing "vicious cycle" that drives preeclampsia. This cycle operates through five interconnected mechanisms:</p><ol> <li><strong>Tropism ("Lock &amp; Label")</strong>: F. nucleatum's Fap2 adhesin binds Gal-GalNAc glycans on EVT cells, with GALNT1 acting as the molecular "address label" [Ref17, Ref18].</li> <li><strong>Nutrient Exploitation ("Dinner Bell")</strong>: Bacterial colonization is sustained by ethanolamine released during tissue remodeling, providing a competitive metabolic advantage [Ref21, Ref22].</li> <li><strong>Barrier Breakdown ("Remodeling Highway")</strong>: MMP-mediated ECM degradation, normally part of EVT invasion, is co-opted by bacteria to breach the placental barrier [Ref27].</li> <li><strong>Immune Dysregulation ("Immune Privilege Collapse")</strong>: The tolerogenic environment (HLA-G, IDO1, TGFB1) that protects the fetus is disrupted, triggering inflammatory cascades [Ref16].</li> <li><strong>Toxic Amplification ("Toxic Switch")</strong>: Bacterial metabolites (H2S, ammonia) cause direct tissue damage and endothelial dysfunction, mimicking preeclampsia pathology [Ref25, Ref26].</li> </ol><h3>1.2 Data Sources</h3><table class="e-rte-table"> <thead> <tr> <th>Dataset</th> <th>Platform</th> <th>Cells</th> <th>Genes</th> <th>Timepoints</th> <th>Source</th> </tr> </thead> <tbody><tr> <td>Multiome Reference</td> <td>10x Multiome (RNA)</td> <td>36,456</td> <td>36,546</td> <td>W7–W11</td> <td>Broad SCP2601 [Ref01]</td> </tr> <tr> <td>Slide-tags Spatial</td> <td>Slide-tags RNA</td> <td>1,923</td> <td>22,083</td> <td>W9</td> <td>Broad SCP2601 [Ref02]</td> </tr> <tr> <td>STARmap-ISS Spatial</td> <td>STARmap-ISS</td> <td>9,041</td> <td>1,004 (raw)</td> <td>W7, W8, W9, W11</td> <td>Zenodo [Ref03]</td> </tr> </tbody></table><h3>1.3 Cell Types Identified</h3><p>The multiome reference contains 17 cell types: EVT1, EVT2, EVT3, vCTB1, vCTB2, vCTB3, vCTBp, STB, Fibroblast1, Fibroblast2, Maternal.fibroblast, Endothelial_cells, Hofbauer.cells, maternal.macrophages, myeloid_unknown, unknown1, unknown2.</p><hr><h2>2. Analytical Methods</h2><h3>2.1 Reference Preprocessing (Script 02A)</h3><p><strong>Hypothesis:</strong> The multiome RNA dataset provides a comprehensive transcriptomic reference that can serve as a taxonomy for annotating spatially-resolved datasets.</p><p><strong>Method:</strong> Standard Seurat v5 pipeline [Ref04]:</p><ul> <li><strong>Normalization:</strong> LogNormalize (data detected as pre-normalized) or SCTransform [Ref05] if UMI-like counts detected. The <code>infer_counts_type()</code> heuristic samples 5,000 non-zero values and checks: (a) fraction that are integer-like (≥99% → UMI), (b) presence of negative values (→ normalized).</li> <li><strong>Feature Selection:</strong> 2,000 highly variable genes via variance-stabilizing transformation.</li> <li><strong>Dimensionality Reduction:</strong> PCA (50 components), UMAP (30 PCs) [Ref07], optional tSNE [Ref08].</li> <li><strong>Clustering:</strong> Shared nearest neighbor (SNN) graph with Louvain clustering at resolution 0.5.</li> </ul><p><strong>Justification:</strong> LogNormalize is appropriate here because the multiome data appears pre-normalized (non-integer values). The 2,000 HVG threshold balances signal retention with noise reduction. UMAP with 30 PCs captures the major axes of variation while filtering technical noise.</p><h3>2.2 Cross-Platform Label Transfer (Scripts 03A, 03B)</h3><p><strong>Hypothesis:</strong> Cell type identities can be reliably transferred from the multiome reference to spatially-resolved datasets despite platform differences.</p><p><strong>Method:</strong> Seurat's CCA-based anchor finding [Ref06, Ref09]:</p><ol> <li>Identify mutual nearest neighbors (anchors) between reference and query in CCA space.</li> <li>Transfer cell type labels weighted by anchor confidence scores.</li> <li>Each cell receives a <code>predicted.id</code> and per-class <code>prediction.score</code>.</li> </ol><p><strong>Justification:</strong> CCA-based transfer is robust to batch effects and platform differences because it identifies shared biological variation rather than technical artifacts. The prediction score provides a built-in confidence metric.</p><p><strong>Quality Control:</strong></p><ul> <li>Cells with <code>prediction.score.max ≥ 0.70</code> are considered high-confidence.</li> <li>Cells with <code>prediction.score.max ≥ 0.85</code> can refine broad author labels.</li> <li>UMAP visualization confirms that transferred labels form coherent clusters.</li> </ul><p><strong>Special Handling for STARmap:</strong></p><ul> <li>The raw STARmap panel has only ~1,004 genes, limiting direct transfer accuracy.</li> <li>When available, the imputed expression matrix (~36k genes) is preferred for visualization and scoring.</li> <li>Gene overlap with the reference is computed for each assay to select the best one.</li> </ul><h3>2.3 Cell Type Harmonization (Script 03C)</h3><p><strong>Hypothesis:</strong> A conservative harmonization strategy that preserves author annotations while filling gaps with high-confidence predictions yields the most reliable cell type labels.</p><p><strong>Method:</strong> Three-tier labeling:</p><ol> <li><strong>Conservative:</strong> Author label if available and not "unknown"; else predicted label if score ≥ 0.70; else "unknown".</li> <li><strong>Refined:</strong> Optionally refine broad author labels (e.g., "immune") to predicted subtypes when score ≥ 0.85.</li> <li><strong>Lineage Rescue:</strong> For remaining "unknown" cells, score major lineage markers (EVT, vCTB, STB, Endothelial, Fibroblast, Macrophage, NK) using AddModuleScore [Ref10]. Assign lineage label if the top score exceeds the 75th percentile.</li> </ol><p><strong>Justification:</strong> This conservative approach minimizes false assignments while maximizing coverage. The lineage rescue step uses well-established marker genes rather than statistical predictions, providing an orthogonal validation.</p><p><strong>Adaptive Parameters (Critical Fix):</strong></p><ul> <li><code>nbin</code> is scaled to dataset size: 3 (&lt; 50 cells), 5 (&lt; 100), 10 (&lt; 500), 15 (&lt; 2000), 24 (≥ 2000).</li> <li><code>ctrl</code> (control gene set size) is set to min(100, max(5, n_genes, ncells/10)).</li> <li>This prevents the "insufficient data values to produce N bins" error.</li> </ul><h3>2.4 Timecourse Analysis (Scripts 04A–04C)</h3><p><strong>Hypothesis:</strong> Key genes and pathways in the vicious cycle show coordinated temporal dynamics across gestational weeks, with inflection points that correspond to critical windows of vulnerability.</p><p><strong>Methods:</strong></p><ul> <li><strong>04A — Gene of Interest Timecourse:</strong> Expression of hypothesis-driven genes (GALNT1, MMP2, MMP9, HLA-G, PLD1, etc.) plotted across gestational weeks, stratified by cell type. Uses violin plots with overlaid box plots for distribution visualization.</li> <li><strong>04B — Immune Subset Refinement:</strong> Sub-clustering of immune cells (Hofbauer, maternal macrophages, NK) to identify activation states. Uses iterative clustering at multiple resolutions.</li> <li><strong>04C — Gene Coordination Score:</strong> Pairwise correlation of vicious cycle genes within cell types across time. High coordination suggests co-regulation and pathway activation.</li> </ul><p><strong>Justification:</strong> Temporal analysis is essential because the placenta undergoes dramatic remodeling between weeks 7–11, and the vicious cycle hypothesis predicts specific temporal patterns (e.g., GALNT1 peaks before immune activation).</p><h3>2.5 Spatial Analysis (Scripts 05A–05C)</h3><p><strong>Hypothesis:</strong> The spatial organization of cell types and gene expression reveals functional microdomains ("killing zones," "permissive zones") that are critical to the vicious cycle.</p><p><strong>Methods:</strong></p><ul> <li><strong>05A — Spatial Overview:</strong> Cell type maps in physical coordinates (μm), colored by cell type and gene expression.</li> <li><strong>05B — Neighborhood Enrichment:</strong> For each cell type pair, compute the observed frequency of co-localization within k=15 nearest neighbors, then compare to a null distribution from N=200 label permutations. Report z-scores [Ref11, Ref12].</li> <li><strong>05C — Permissiveness Score Maps:</strong> Composite spatial scores combining Fap2 target expression, ethanolamine pathway activity, and ECM remodeling to identify regions most vulnerable to bacterial colonization.</li> </ul><p><strong>Justification:</strong> Spatial context is irreplaceable for testing the vicious cycle hypothesis because the cycle depends on physical proximity between cell types (e.g., EVT near immune cells, bacteria near remodeling zones). The 50 μm distance threshold for the "killing zone" is biologically appropriate for cell-cell interactions in tissue.</p><h3>2.6 Cell-Cell Communication (Scripts 06A–06B)</h3><p><strong>Hypothesis:</strong> Ligand-receptor interactions between placental cell types create signaling networks that are disrupted during the vicious cycle, particularly immune checkpoint pathways.</p><p><strong>Methods:</strong></p><ul> <li><strong>06A — CellChat (Optional):</strong> Spatially-constrained ligand-receptor inference using the CellChat database [Ref13]. Only considers interactions between cells within spatial proximity.</li> <li><strong>06B — Simple LR Scoring:</strong> Lightweight scoring of curated ligand-receptor pairs (HLA-G/LILRB1, TGFB1/TGFBR1, VEGFA/KDR, etc.) without requiring CellChat installation.</li> </ul><p><strong>Justification:</strong> The curated LR pair list focuses on pathways directly relevant to the vicious cycle hypothesis, providing interpretable results even without the full CellChat framework.</p><h3>2.7 Metagene Analysis (Scripts 08A–08C)</h3><p><strong>Hypothesis:</strong> Data-driven gene modules (metagenes) reveal coordinated transcriptional programs that correspond to vicious cycle components and may identify novel pathway members.</p><p><strong>Methods:</strong></p><ul> <li><strong>08A — Housekeeping Diagnostics:</strong> Identify stably-expressed genes across cell types and timepoints to serve as normalization controls and quality benchmarks.</li> <li><strong>08B — Module Discovery:</strong> Non-negative matrix factorization (NMF) or weighted gene co-expression network analysis (WGCNA) to identify co-expressed gene modules.</li> <li><strong>08C — Spatiotemporal Maps:</strong> Project discovered modules onto spatial coordinates and gestational time to identify where and when each program is active.</li> </ul><p><strong>Justification:</strong> Unbiased module discovery complements the hypothesis-driven gene signatures by identifying unexpected co-expression patterns that may reveal new components of the vicious cycle.</p><hr><h2>3. Gene Signatures &amp; Biological Rationale</h2><h3>3.1 Bacterial Adhesion Targets</h3><table class="e-rte-table"> <thead> <tr> <th>Signature</th> <th>Key Genes</th> <th>Rationale</th> <th>Citation</th> </tr> </thead> <tbody><tr> <td>Fap2 Targets</td> <td>GALNT1, GALNT2, GALNT3, C1GALT1</td> <td>Gal-GalNAc glycosylation enzymes — the "address label"</td> <td>[Ref17, Ref18]</td> </tr> <tr> <td>FadA Targets</td> <td>CDH1, CTNNB1, EPCAM</td> <td>E-cadherin complex — bacterial entry receptor</td> <td>[Ref19]</td> </tr> </tbody></table><h3>3.2 Metabolic Pathways</h3><table class="e-rte-table"> <thead> <tr> <th>Signature</th> <th>Key Genes</th> <th>Rationale</th> <th>Citation</th> </tr> </thead> <tbody><tr> <td>Ethanolamine</td> <td>PLD1, ETNK1, ETNK2, PCYT2, SELENOI</td> <td>Ethanolamine synthesis — the "dinner bell"</td> <td>[Ref21, Ref22]</td> </tr> </tbody></table><h3>3.3 ECM Remodeling</h3><table class="e-rte-table"> <thead> <tr> <th>Signature</th> <th>Key Genes</th> <th>Rationale</th> <th>Citation</th> </tr> </thead> <tbody><tr> <td>MMP Remodeling</td> <td>MMP2, MMP9, MMP14, ADAMTS4/5</td> <td>Matrix degradation — the "remodeling highway"</td> <td>[Ref27]</td> </tr> <tr> <td>ECM Structure</td> <td>COL1A1, COL3A1, FN1, DCN</td> <td>Structural components being degraded</td> <td>[Ref01]</td> </tr> </tbody></table><h3>3.4 Immune Signatures</h3><table class="e-rte-table"> <thead> <tr> <th>Signature</th> <th>Key Genes</th> <th>Rationale</th> <th>Citation</th> </tr> </thead> <tbody><tr> <td>Immune Tolerance</td> <td>HLA-G, CD274, IDO1, TGFB1, IL10</td> <td>Tolerogenic signals — "immune privilege"</td> <td>[Ref16]</td> </tr> <tr> <td>Cytotoxic NK</td> <td>NKG7, GNLY, PRF1, GZMB</td> <td>NK cell activation — killing zone</td> <td>[Ref16]</td> </tr> <tr> <td>Myeloid Inflammation</td> <td>IL1B, TNF, CXCL8, S100A8/A9</td> <td>Inflammatory macrophage activation</td> <td>[Ref16]</td> </tr> </tbody></table><h3>3.5 Toxic Switch</h3><table class="e-rte-table"> <thead> <tr> <th>Signature</th> <th>Key Genes</th> <th>Rationale</th> <th>Citation</th> </tr> </thead> <tbody><tr> <td>H2S Metabolism</td> <td>CBS, CTH, MPST, SQOR</td> <td>Hydrogen sulfide production/detox</td> <td>[Ref25, Ref26]</td> </tr> <tr> <td>Ammonia Metabolism</td> <td>GLS, GLUD1, CPS1, OTC</td> <td>Ammonia production from glutamine</td> <td>[Ref25]</td> </tr> </tbody></table><h3>3.6 Vascular Dysfunction</h3><table class="e-rte-table"> <thead> <tr> <th>Signature</th> <th>Key Genes</th> <th>Rationale</th> <th>Citation</th> </tr> </thead> <tbody><tr> <td>Endothelial Activation</td> <td>VCAM1, ICAM1, FLT1, PGF, VEGFA</td> <td>PE-like vascular stress</td> <td>[Ref23, Ref24]</td> </tr> <tr> <td>Hypoxia Response</td> <td>HIF1A, VEGFA, SLC2A1, LDHA, CA9</td> <td>Oxygen deprivation response</td> <td>[Ref23]</td> </tr> </tbody></table><hr><h2>4. Quality Control &amp; Validation</h2><h3>4.1 Data Quality Metrics</h3><ul> <li><strong>Multiome Reference:</strong> 36,456 cells, 36,546 features, 17 cell types. Pre-normalized counts (LogNormalize pipeline applied).</li> <li><strong>Slide-tags:</strong> 1,923 cells, 22,083 features. Already has predicted.id from prior mapping. Spatial coordinates in μm.</li> <li><strong>STARmap:</strong> 9,041 cells, 1,004 raw genes (+ imputed transcriptome). Split across W7, W8-2, W9 samples. Spatial coordinates in μm.</li> </ul><h3>4.2 Validation Approaches</h3><ol> <li><strong>Cross-platform concordance:</strong> Compare cell type proportions between multiome, Slide-tags, and STARmap.</li> <li><strong>Marker gene validation:</strong> Verify that assigned cell types express expected canonical markers.</li> <li><strong>Spatial coherence:</strong> Confirm that cell types form spatially coherent domains rather than random distributions.</li> <li><strong>Prediction confidence:</strong> Filter low-confidence predictions (score &lt; 0.70) for downstream analyses.</li> </ol><hr><h2>5. Technical Notes</h2><h3>5.1 Seurat v5 Compatibility</h3><p>This pipeline is tested with Seurat v5.4.0 and SeuratObject v5.1.0. Key v5-specific considerations:</p><ol> <li><strong>Split Layers:</strong> Seurat v5 can store data in split layers (e.g., <code>counts.W7</code>, <code>counts.W8</code>). All scripts call <code>safe_join_layers()</code> before processing.</li> <li><strong>Metadata/Reduction Clash:</strong> The Slide-tags object has <code>umap_1</code>/<code>umap_2</code> as metadata columns from a prior analysis. These are automatically renamed to <code>meta_umap_1</code>/<code>meta_umap_2</code> to prevent conflicts with the UMAP reduction.</li> <li><strong>Adaptive Module Scoring:</strong> <code>AddModuleScore</code> nbin parameter is scaled to dataset size to prevent "insufficient bins" errors.</li> </ol><h3>5.2 Coordinate Systems</h3><ul> <li>All spatial coordinates are in <strong>micrometers (μm)</strong>.</li> <li>The 50 μm distance threshold for "killing zone" analysis is biologically appropriate for cell-cell interactions [Ref01].</li> </ul><hr><h2>6. References</h2><p>All references are maintained in the <strong>Source Manifest</strong> (<code>docs/SOURCE_MANIFEST.md</code>). See that file for the complete bibliography with annotations.</p><hr><p><em>Report generated for the Placenta Vicious Cycle Analysis Pipeline.</em> <em>For questions about methods, see the individual script headers and the Source Manifest.</em></p>